{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>學生列表</h2>
    <a href="{{ url_for('student_management.add_student') }}" class="btn btn-primary">
        <i class="fas fa-plus"></i> 新增學生
    </a>
</div>

<div class="table-responsive">
    <table class="table table-striped table-hover">
        <thead class="table-dark">
            <tr>
                <th>學號</th>
                <th>姓名</th>
                <th>班級</th>
                <th>狀態</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            {% for student in students.items %}
            <tr>
                <td>{{ student.student_id }}</td>
                <td>{{ student.name }}</td>
                <td>{{ student.class_info.class_name if student.class_info else '未分配' }}</td>
                <td>{{ student.status }}</td>
                <td>
                    <a href="{{ url_for('student_management.view_student', student_id=student.student_id) }}"
                       class="btn btn-sm btn-info" title="檢視">
                        <i class="fas fa-eye"></i>
                    </a>
                    <a href="{{ url_for('student_management.edit_student', student_id=student.student_id) }}"
                       class="btn btn-sm btn-warning" title="編輯">
                        <i class="fas fa-edit"></i>
                    </a>
                    <form method="post" action="{{ url_for('student_management.delete_student', student_id=student.student_id) }}"
                          class="d-inline" onsubmit="return confirm('確定要刪除該學生嗎？');">
                        <button type="submit" class="btn btn-sm btn-danger" title="刪除">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<nav aria-label="Page navigation">
    <ul class="pagination justify-content-center">
        {% if students.has_prev %}
        <li class="page-item">
            <a class="page-link" href="{{ url_for('student_management.list_students', page=students.prev_num) }}">上一頁</a>
        </li>
        {% else %}
        <li class="page-item disabled">
            <a class="page-link" href="#" tabindex="-1">上一頁</a>
        </li>
        {% endif %}
        
        {% for page_num in students.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
            {% if page_num %}
                {% if students.page == page_num %}
                <li class="page-item active">
                    <a class="page-link" href="{{ url_for('student_management.list_students', page=page_num) }}">{{ page_num }}</a>
                </li>
                {% else %}
                <li class="page-item">
                    <a class="page-link" href="{{ url_for('student_management.list_students', page=page_num) }}">{{ page_num }}</a>
                </li>
                {% endif %}
            {% else %}
                <li class="page-item disabled">
                    <a class="page-link" href="#">...</a>
                </li>
            {% endif %}
        {% endfor %}
        
        {% if students.has_next %}
        <li class="page-item">
            <a class="page-link" href="{{ url_for('student_management.list_students', page=students.next_num) }}">下一頁</a>
        </li>
        {% else %}
        <li class="page-item disabled">
            <a class="page-link" href="#" tabindex="-1">下一頁</a>
        </li>
        {% endif %}
    </ul>
</nav>
{% endblock %}